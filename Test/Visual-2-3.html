<!DOCTYPE html>
<!-- saved from url=(0054)http://dc-js.github.io/dc.js/examples/stacked-bar.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  </head>
  <body>


<div id="map"></div>
<div id="pie-chart"></div>

    <script src="https://d3js.org/d3.v4.min.js" charset="utf-8"></script>
<script>
    d3.csv("data/result.csv", function(error, data) {
                if (error) throw error;
                console.log(data);

    const margin = {top: 20, right: 0, bottom: 0, left: 20};
    const visWidth = 600 - margin.left - margin.right;
    const visHeight = 400 - margin.top - margin.bottom;
  
    const svg = d3.select(DOM.svg(visWidth + margin.left + margin.right,
                                  visHeight + margin.top + margin.bottom));
  
    const g = svg.append('g')
        .attr('transform', `translate(${margin.left}, ${margin.top})`);
    
    
     // create scale
  
    const maxRadius = 20;
  
    const radius1 = d3.scaleSqrt()
        .domain([0, d3.max(result, d => d.Net)])
        .range([0, maxRadius]);
    
    const radius2 = d3.scaleSqrt()
        .domain([d3.min(result, d => d.Net, 0)])
        .range([0, maxRadius]);
 // Legend 2
    
    // draw map
    
    const projection =  d3.geoMercator()
        .fitSize([visWidth, visHeight], usaGeo);
  
    const path = d3.geoPath().projection(projection);
    
    g.append("path")
        .datum(usaGeo)
        .attr("d", path)
        .attr("fill", lightgray)
        .attr("stroke", "white")
   
    
  //draw circles
    g.selectAll(".dot")
      .data(unemployment.filter(d => stateToGeo.hasOwnProperty(d.state)))
      .join("circle")
        .attr("class", "dot")
        .attr("fill", "steelblue")
        .attr("cx", d => {
        
          const [x, y] = path.centroid(stateToGeo[d.state]);
          return x;
        })
        .attr("cy", d => {
          const [x, y] = path.centroid(stateToGeo[d.state]);
          return y;
        })
        .attr("r", d => radius(d.rate))  
    
    

  }

</script>


</body>
</html>